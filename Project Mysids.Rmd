---
title: "Project Mysids"
author: "Liz Allyn"
date: "`r Sys.Date()`"
output: word_document
editor_options: 
  markdown: 
    wrap: 72
---

```{r message = F, echo = F}
library(knitr)
```

# Characterizing Mysid (Crustacea: Mysida) swarms and their co-occurrence with gray whales (Eschrichtius robustus) in northwest Washington State

## Research Questions

### Descriptive:

-   What is the species composition of mysid shrimp in the study area?
-   What is the size, age, maturity composition of mysid shrimp in the
    study area?
-   How does mysid shrimp distribution vary by sample site?

### Modeling:

-   Does mysid shrimp density predict gray whale presence?

## Methods

## Data Organization

```{r}
# Read in Data
data <- read.csv("Er prey analysis for R fixed whale presence.csv")

#


```

## Model Construction

Options:

Response: 
Whale counts near sampling sites during sampling - zero-inflated. Hurdle model.
Zeros w/ Bernoulli, non-0 counts check for overdispersion - Poisson vs neg binom.

Pull out non-zero counts and check for overdispersion and GOF generally.

```{r}
library(VGAM)

# pull out non-zero counts
nonzero <- data[which(data$whalecount > 0),]

# look at them
hist(nonzero$whalecount)

# construct model with mysid count
m1 <- vglm(whalecount ~ MysidCount, data = nonzero, family = "pospoisson")

# check for overdispersion
pchisq(sum(residuals(m1,type = "pearson")^2),nrow(nonzero)-2,lower.tail = FALSE)
# p = 0.000005, overdispersed

# fit with ZT neg binom
m2 <- vglm(whalecount ~ MysidCount, data = nonzero, family = posnegbinomial)
summary(m2)

# check for overdispersion
pchisq(sum(residuals(m2,type = "pearson")^2),nrow(nonzero)-2,lower.tail = FALSE)
```

Since the non-zero count data is overdispersed, we need to use the negative binomial distribution instead of Poisson in our hurdle model.

Next we will construct the hurdle model.

```{r}
library(pscl)
m.hurdle <- 
```


Fixed Effects: 
+ Mysid Count 
+ Mysid Avg Size 
+ Mysid Gravid Prop 
+ Mysid NR:HS Ratio (expect interaction w/count) 
+ Month 
+ Temp?
+ Kelp Cover?

Random Effects: 
+ Site 
+ Date?

```{r}
# model creation

# intercept only
m0 <- glm(data = data, whale.presence ~ MysidCount, family = "poisson")
```

## Diagnostics

```{r}

```
